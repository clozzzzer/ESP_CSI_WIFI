{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      tagList: [{\n        text: 'alert',\n        value: '1'\n      }, {\n        text: 'safe',\n        value: '0'\n      }],\n      dateList: [{\n        text: '2024-05-28',\n        value: '2024-05-28'\n      }, {\n        text: '2024-05-29',\n        value: '2024-05-29'\n      }, {\n        text: '2024-05-30',\n        value: '2024-05-30'\n      }],\n      nameList: [{\n        text: 'WS',\n        value: 'WS'\n      }],\n      tableData: [],\n      isFirst: true\n    };\n  },\n  created() {\n    this.getWSData();\n  },\n  methods: {\n    filterTag(value, row) {\n      return row.tag === value;\n    },\n    filterHandler(value, row) {\n      return row.date === value;\n    },\n    filtername(value, row) {\n      return row.name === value;\n    },\n    getWSData() {\n      const ws = new WebSocket('ws://127.0.0.1:5000');\n      ws.onopen = () => {\n        console.log('WebSocket connection established');\n      };\n      ws.onmessage = event => {\n        const data = JSON.parse(event.data);\n        if (!this.isFirst) {\n          this.loadWS(data);\n          //console.log(data);\n        }\n        this.isFirst = false;\n      };\n      ws.onclose = () => {\n        console.log('WebSocket connection closed');\n      };\n      ws.onerror = error => {\n        console.error('WebSocket error:', error);\n      };\n    },\n    loadWS(data) {\n      //btime stime type\n      /*         let date = 0;\r\n              let start = 0;\r\n              let stop = 0; */\n      let tag = null;\n      console.log(data);\n      for (let i = data.length - 1; i >= 0; i--) {\n        if (data[i].type1 === '0') {\n          tag = 'safe';\n        } else {\n          tag = 'alert';\n        }\n        this.tableData.push({\n          date: data[i].sdate,\n          start: data[i].btime,\n          end: data[i].stime,\n          name: 'WS',\n          location: '卧室',\n          tag: tag,\n          id: data.length - i + 1\n        });\n      }\n    },\n    handleClick(id) {\n      this.tableData = this.tableData.filter(item => item.id !== id);\n    }\n  }\n};","map":{"version":3,"names":["data","tagList","text","value","dateList","nameList","tableData","isFirst","created","getWSData","methods","filterTag","row","tag","filterHandler","date","filtername","name","ws","WebSocket","onopen","console","log","onmessage","event","JSON","parse","loadWS","onclose","onerror","error","i","length","type1","push","sdate","start","btime","end","stime","location","id","handleClick","filter","item"],"sources":["src/components/LogBaseTwo.vue"],"sourcesContent":["<template>\r\n  <div class=\"log-base-two\" style=\"border-radius: 30px;display:flex\">\r\n      <el-table\r\n    ref=\"filterTable\"\r\n    :data=\"tableData\"\r\n    style=\"width: 80%;border-radius: 30px;margin-left:20px;\"\r\n    height=\"100%\">\r\n    <el-table-column\r\n      prop=\"date\"\r\n      label=\"日期\"\r\n      sortable\r\n      width=\"150\"\r\n      column-key=\"date\"\r\n      :filters=\"dateList\"\r\n      :filter-method=\"filterHandler\"\r\n    >\r\n    </el-table-column>\r\n    <el-table-column\r\n      prop=\"start\"\r\n      label=\"开始时间\"\r\n      width=\"150\">\r\n    </el-table-column>\r\n        <el-table-column\r\n      prop=\"end\"\r\n      label=\"结束时间\"\r\n      width=\"150\">\r\n    </el-table-column>\r\n    <el-table-column\r\n      prop=\"name\"\r\n      label=\"设备\"\r\n      width=\"150\"\r\n      :filters=\"nameList\"\r\n      :filter-method=\"filtername\">\r\n    </el-table-column>\r\n    <el-table-column\r\n      prop=\"location\"\r\n      label=\"位置\"\r\n      width=\"140\"\r\n    >\r\n    </el-table-column>\r\n    <el-table-column\r\n      prop=\"tag\"\r\n      label=\"标签\"\r\n      width=\"140\"\r\n      :filters=\"tagList\"\r\n      :filter-method=\"filterTag\"\r\n      filter-placement=\"bottom-end\">\r\n      <template slot-scope=\"scope\">\r\n        <el-tag\r\n          v-if=\"scope.row.tag==='alert'\" type=\"danger\" effect=\"dark\"\r\n          disable-transitions>{{scope.row.tag}}</el-tag>\r\n        <el-tag\r\n          v-else-if=\"scope.row.tag==='safe'\" type=\"success\" effect=\"dark\"\r\n          disable-transitions>{{scope.row.tag}}</el-tag>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column\r\n      label=\"操作\"\r\n      >\r\n      <template slot-scope=\"scope\">\r\n        <el-button @click=\"handleClick(scope.row.id)\" type=\"text\" size=\"small\">已读</el-button>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            tagList:[{ text: 'alert', value: '1' }, { text: 'safe', value: '0' }],\r\n            dateList:[{text: '2024-05-28', value: '2024-05-28'}, {text: '2024-05-29', value: '2024-05-29'}, {text: '2024-05-30', value: '2024-05-30'}],\r\n            nameList:[{text:'WS',value:'WS'}],\r\n            tableData: [],\r\n            isFirst : true\r\n        }\r\n    },\r\n    created() {\r\n      this.getWSData();\r\n    },\r\n        methods: {\r\n      filterTag(value, row) {\r\n        return row.tag === value;\r\n      },\r\n      filterHandler(value, row) {\r\n        return row.date === value;\r\n      },\r\n      filtername(value,row) {\r\n        return row.name === value;\r\n      },\r\n      getWSData () {\r\n      const ws = new WebSocket('ws://127.0.0.1:5000');\r\n\r\n      ws.onopen = () => {\r\n        console.log('WebSocket connection established');\r\n      };\r\n\r\n      ws.onmessage = (event) => {\r\n        const data = JSON.parse(event.data);\r\n        if(!this.isFirst)\r\n        {\r\n            this.loadWS(data);\r\n            //console.log(data);\r\n        }\r\n        this.isFirst = false;\r\n      };\r\n\r\n      ws.onclose = () => {\r\n        console.log('WebSocket connection closed');\r\n      };\r\n\r\n      ws.onerror = (error) => {\r\n        console.error('WebSocket error:', error);\r\n      };\r\n      },\r\n      loadWS (data) {\r\n        //btime stime type\r\n/*         let date = 0;\r\n        let start = 0;\r\n        let stop = 0; */\r\n        let tag = null;\r\n        console.log(data)\r\n        for(let i = data.length-1;i>=0;i--)\r\n        {\r\n          if(data[i].type1 === '0')\r\n          { tag = 'safe'}\r\n          else\r\n          {\r\n             tag = 'alert'\r\n          }\r\n          this.tableData.push({\r\n            date: data[i].sdate,\r\n            start: data[i].btime,\r\n            end: data[i].stime,\r\n            name: 'WS',\r\n            location:'卧室',\r\n            tag: tag,\r\n            id : data.length - i + 1\r\n          })\r\n        }\r\n      },\r\n      handleClick (id) {\r\n        this.tableData = this.tableData.filter(item => item.id !== id);\r\n      }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.log-base-two {\r\n    background-color: white;\r\n    width: 70%;\r\n    height: 80%;\r\n    border: 1px solid #ffffff; /* 边框样式 */\r\n    float: right;\r\n    margin-top: 50px;\r\n    display: flex;\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n    align-items: center; /* 垂直居中 */\r\n}\r\n</style>"],"mappings":";AAoEA;EACAA,KAAA;IACA;MACAC,OAAA;QAAAC,IAAA;QAAAC,KAAA;MAAA;QAAAD,IAAA;QAAAC,KAAA;MAAA;MACAC,QAAA;QAAAF,IAAA;QAAAC,KAAA;MAAA;QAAAD,IAAA;QAAAC,KAAA;MAAA;QAAAD,IAAA;QAAAC,KAAA;MAAA;MACAE,QAAA;QAAAH,IAAA;QAAAC,KAAA;MAAA;MACAG,SAAA;MACAC,OAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,SAAA;EACA;EACAC,OAAA;IACAC,UAAAR,KAAA,EAAAS,GAAA;MACA,OAAAA,GAAA,CAAAC,GAAA,KAAAV,KAAA;IACA;IACAW,cAAAX,KAAA,EAAAS,GAAA;MACA,OAAAA,GAAA,CAAAG,IAAA,KAAAZ,KAAA;IACA;IACAa,WAAAb,KAAA,EAAAS,GAAA;MACA,OAAAA,GAAA,CAAAK,IAAA,KAAAd,KAAA;IACA;IACAM,UAAA;MACA,MAAAS,EAAA,OAAAC,SAAA;MAEAD,EAAA,CAAAE,MAAA;QACAC,OAAA,CAAAC,GAAA;MACA;MAEAJ,EAAA,CAAAK,SAAA,GAAAC,KAAA;QACA,MAAAxB,IAAA,GAAAyB,IAAA,CAAAC,KAAA,CAAAF,KAAA,CAAAxB,IAAA;QACA,UAAAO,OAAA,EACA;UACA,KAAAoB,MAAA,CAAA3B,IAAA;UACA;QACA;QACA,KAAAO,OAAA;MACA;MAEAW,EAAA,CAAAU,OAAA;QACAP,OAAA,CAAAC,GAAA;MACA;MAEAJ,EAAA,CAAAW,OAAA,GAAAC,KAAA;QACAT,OAAA,CAAAS,KAAA,qBAAAA,KAAA;MACA;IACA;IACAH,OAAA3B,IAAA;MACA;MACA;AACA;AACA;MACA,IAAAa,GAAA;MACAQ,OAAA,CAAAC,GAAA,CAAAtB,IAAA;MACA,SAAA+B,CAAA,GAAA/B,IAAA,CAAAgC,MAAA,MAAAD,CAAA,OAAAA,CAAA,IACA;QACA,IAAA/B,IAAA,CAAA+B,CAAA,EAAAE,KAAA,UACA;UAAApB,GAAA;QAAA,OAEA;UACAA,GAAA;QACA;QACA,KAAAP,SAAA,CAAA4B,IAAA;UACAnB,IAAA,EAAAf,IAAA,CAAA+B,CAAA,EAAAI,KAAA;UACAC,KAAA,EAAApC,IAAA,CAAA+B,CAAA,EAAAM,KAAA;UACAC,GAAA,EAAAtC,IAAA,CAAA+B,CAAA,EAAAQ,KAAA;UACAtB,IAAA;UACAuB,QAAA;UACA3B,GAAA,EAAAA,GAAA;UACA4B,EAAA,EAAAzC,IAAA,CAAAgC,MAAA,GAAAD,CAAA;QACA;MACA;IACA;IACAW,YAAAD,EAAA;MACA,KAAAnC,SAAA,QAAAA,SAAA,CAAAqC,MAAA,CAAAC,IAAA,IAAAA,IAAA,CAAAH,EAAA,KAAAA,EAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}